(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-237894cf"],{"5ce8":function(e,t,s){},"6c69":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"order-submission"},[s("div",{staticClass:"allAddress",style:e.store_self_mention?"":"padding-top: 0.2rem"},[s("div",{staticClass:"nav acea-row"},[e.store_self_mention?s("div",{staticClass:"item font-color-red",class:0===e.shipping_type?"on":"on2",on:{click:function(t){return e.addressType(0)}}}):e._e(),e.store_self_mention?s("div",{staticClass:"item font-color-red",class:1===e.shipping_type?"on":"on2",on:{click:function(t){return e.addressType(1)}}}):e._e()]),0===e.shipping_type?s("div",{staticClass:"address acea-row row-between-wrapper",on:{click:e.addressTap}},[e.addressInfo.real_name?s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[e._v("\n          "+e._s(e.addressInfo.real_name)+"\n          "),s("span",{staticClass:"phone"},[e._v(e._s(e.addressInfo.phone))])]),s("div",[e.addressInfo.is_default?s("span",{staticClass:"default font-color-red"},[e._v("[默认]")]):e._e(),e._v("\n          "+e._s(e.addressInfo.province)+e._s(e.addressInfo.city)+e._s(e.addressInfo.district)+e._s(e.addressInfo.detail)+"\n        ")])]):s("div",{staticClass:"addressCon"},[s("div",{staticClass:"setaddress"},[e._v("设置收货地址")])]),s("div",{staticClass:"iconfont icon-jiantou"})]):s("div",{staticClass:"address acea-row row-between-wrapper"},[s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[e._v("\n          "+e._s(e.system_store.name)+"\n          "),s("span",{staticClass:"phone"},[e._v(e._s(e.system_store.phone))])]),s("div",[e._v("\n          "+e._s(e.system_store._detailed_address)+"\n        ")])])]),e._m(0)]),s("OrderGoods",{attrs:{evaluate:0,cartInfo:e.orderGroupInfo.cartInfo}}),s("div",{staticClass:"wrapper"},[!1===e.deduction?s("div",{staticClass:"item acea-row row-between-wrapper",on:{click:e.couponTap}},[s("div",[e._v("优惠券")]),s("div",{staticClass:"discount"},[e._v("\n        "+e._s(e.usableCoupon.coupon_title||"请选择")+"\n        "),s("span",{staticClass:"iconfont icon-jiantou"})])]):e._e(),!1===e.deduction?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("积分抵扣")]),s("div",{staticClass:"discount"},[s("div",{staticClass:"select-btn"},[s("div",{staticClass:"checkbox-wrapper"},[s("label",{staticClass:"well-check"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.useIntegral,expression:"useIntegral"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.useIntegral)?e._i(e.useIntegral,null)>-1:e.useIntegral},on:{change:function(t){var s=e.useIntegral,a=t.target,i=!!a.checked;if(Array.isArray(s)){var o=null,r=e._i(s,o);a.checked?r<0&&(e.useIntegral=s.concat([o])):r>-1&&(e.useIntegral=s.slice(0,r).concat(s.slice(r+1)))}else e.useIntegral=i}}}),s("i",{staticClass:"icon"}),s("span",{staticClass:"integral"},[e._v("\n                当前积分\n                "),s("span",{staticClass:"num font-color-red"},[e._v("\n                  "+e._s(e.userInfo.integral||0)+"\n                ")])])])])])])]):e._e(),e.orderGroupInfo.priceGroup.vipPrice>0&&e.userInfo.vip&&0==e.pinkId&&0==e.orderGroupInfo.bargain_id&&0==e.orderGroupInfo.combination_id&&0==e.orderGroupInfo.seckill_id?s("div",{staticClass:"item acea-row row-between-wrapper"},[e._v("\n      会员优惠\n      "),s("div",{staticClass:"discount"},[e._v("￥"+e._s(e.orderGroupInfo.priceGroup.vipPrice))])]):e._e(),0===e.shipping_type?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("快递费用")]),s("div",{staticClass:"discount"},[e._v("\n        "+e._s(e.orderGroupInfo.priceGroup.storePostage>0?e.orderGroupInfo.priceGroup.storePostage:"免运费")+"\n      ")])]):s("div",[s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("联系人")]),s("div",{staticClass:"discount"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.contacts,expression:"contacts"}],attrs:{type:"text",placeholder:"请填写您的联系姓名"},domProps:{value:e.contacts},on:{input:function(t){t.target.composing||(e.contacts=t.target.value)}}})])]),s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("联系电话")]),s("div",{staticClass:"discount"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.contactsTel,expression:"contactsTel"}],attrs:{type:"text",placeholder:"请填写您的联系电话"},domProps:{value:e.contactsTel},on:{input:function(t){t.target.composing||(e.contactsTel=t.target.value)}}})])])]),s("div",{staticClass:"item"},[s("div",[e._v("备注信息")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.mark,expression:"mark"}],attrs:{placeholder:"请添加备注（150字以内）"},domProps:{value:e.mark},on:{input:function(t){t.target.composing||(e.mark=t.target.value)}}})])]),s("div",{staticClass:"wrapper"},[s("div",{staticClass:"item"},[s("div",[e._v("支付方式")]),s("div",{staticClass:"list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isWeixin,expression:"isWeixin"}],staticClass:"payItem acea-row row-middle",class:"weixin"===e.active?"on":"",on:{click:function(t){return e.payItem("weixin")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-weixin2",class:"weixin"===e.active?"bounceIn":""}),e._v("\n            微信支付\n          ")]),s("div",{staticClass:"tip"},[e._v("微信快捷支付")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isWeixin,expression:"!isWeixin"}],staticClass:"payItem acea-row row-middle",class:"weixin"===e.active?"on":"",on:{click:function(t){return e.payItem("weixin")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-weixin2",class:"weixin"===e.active?"bounceIn":""}),e._v("\n            微信支付\n          ")]),s("div",{staticClass:"tip"},[e._v("微信快捷支付")])]),s("div",{staticClass:"payItem acea-row row-middle",class:"yue"===e.active?"on":"",on:{click:function(t){return e.payItem("yue")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-icon-test",class:"yue"===e.active?"bounceIn":""}),e._v("\n            余额支付\n          ")]),s("div",{staticClass:"tip"},[e._v("可用余额："+e._s(e.userInfo.now_money||0))])]),1===e.offlinePayStatus&&!1===e.deduction?s("div",{staticClass:"payItem acea-row row-middle",class:"offline"===e.active?"on":"",on:{click:function(t){return e.payItem("offline")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-yinhangqia",class:"offline"===e.active?"bounceIn":""}),e._v("\n            线下支付\n          ")]),s("div",{staticClass:"tip"},[e._v("线下方便支付")])]):e._e()])])]),s("div",{staticClass:"moneyList"},[void 0!==e.orderPrice.total_price?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("商品总价：")]),s("div",{staticClass:"money"},[e._v("￥"+e._s(e.orderPrice.total_price))])]):e._e(),e.orderPrice.pay_postage>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("运费：")]),s("div",{staticClass:"money"},[e._v("￥"+e._s(e.orderPrice.pay_postage))])]):e._e(),e.orderPrice.coupon_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("优惠券抵扣：")]),s("div",{staticClass:"money"},[e._v("-￥"+e._s(e.orderPrice.coupon_price))])]):e._e(),e.orderPrice.deduction_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[e._v("积分抵扣：")]),s("div",{staticClass:"money"},[e._v("-￥"+e._s(e.orderPrice.deduction_price))])]):e._e()]),s("div",{staticStyle:{height:"1.2rem"}}),s("div",{staticClass:"footer acea-row row-between-wrapper"},[s("div",[e._v("\n      合计:\n      "),s("span",{staticClass:"font-color-red"},[e._v("￥"+e._s(e.orderPrice.pay_price))])]),s("div",{staticClass:"settlement",on:{click:e.createOrder}},[e._v("立即结算")])]),s("CouponListWindow",{attrs:{price:e.orderPrice.total_price,checked:e.usableCoupon.id},on:{couponchange:function(t){return e.changecoupon(t)},checked:e.changeCoupon},model:{value:e.showCoupon,callback:function(t){e.showCoupon=t},expression:"showCoupon"}}),s("AddressWindow",{ref:"mychild",attrs:{checked:e.addressInfo.id},on:{checked:e.changeAddress,redirect:e.addressRedirect},model:{value:e.showAddress,callback:function(t){e.showAddress=t},expression:"showAddress"}})],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"line"},[a("img",{attrs:{src:s("afa3")}})])}],o=(s("a481"),s("7f7f"),s("713c")),r=s("f0b9"),n=s("db38"),c=s("f8b7"),d=s("c24f"),l=s("74f9"),p=s("ed08"),u="OrderSubmission",v=Object(p["d"])(),f={name:u,components:{OrderGoods:o["a"],CouponListWindow:r["a"],AddressWindow:n["a"]},props:{},data:function(){return{offlinePayStatus:2,from:v?"weixin":"weixinh5",deduction:!0,isWeixin:v,pinkId:0,active:v?"weixin":"yue",showCoupon:!1,showAddress:!1,addressInfo:{},couponId:0,orderGroupInfo:{priceGroup:{}},usableCoupon:{},addressLoaded:!1,useIntegral:!1,orderPrice:{pay_price:"计算中"},mark:"",system_store:{},shipping_type:0,contacts:"",contactsTel:"",store_self_mention:0,userInfo:{}}},watch:{useIntegral:function(){this.computedPrice()},$route:function(e){e.name===u&&(this.getUserInfo(),this.getCartInfo())},shipping_type:function(){this.computedPrice()}},mounted:function(){var e=this;e.getUserInfo(),e.getCartInfo(),void 0!==e.$route.query.pinkid&&(e.pinkId=e.$route.query.pinkid)},methods:{getUserInfo:function(){var e=this;Object(d["E"])().then(function(t){e.userInfo=t.data}).catch(function(){})},addressType:function(e){if(e&&!this.system_store.id)return this.$dialog.error("暂无门店信息，您无法选择到店自提！");this.shipping_type=e},computedPrice:function(){var e=this,t=this.shipping_type;Object(c["k"])(this.orderGroupInfo.orderKey,{addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,shipping_type:parseInt(t)+1}).then(function(t){var s=t.data;"EXTEND_ORDER"===s.status?e.$router.replace({path:"/order/detail/"+s.result.orderId}):e.orderPrice=s.result})},getCartInfo:function(){var e=this,t=this.$route.params.id;if(!t)return this.$dialog.error("参数有误"),this.$router.go(-1);Object(c["l"])(t).then(function(t){e.offlinePayStatus=t.data.offline_pay_status,e.orderGroupInfo=t.data,e.deduction=t.data.deduction,e.usableCoupon=t.data.usableCoupon||{},e.addressInfo=t.data.addressInfo||{},e.system_store=t.data.system_store||{},e.store_self_mention=t.data.store_self_mention,e.computedPrice()}).catch(function(){e.$dialog.error("加载订单数据失败")})},addressTap:function(){this.showAddress=!0,this.addressLoaded||(this.addressLoaded=!0,this.$refs.mychild.getAddressList())},addressRedirect:function(){this.addressLoaded=!1,this.showAddress=!1},couponTap:function(){this.showCoupon=!0},changeCoupon:function(e){this.usableCoupon=e||{coupon_title:"不使用优惠券",id:0},this.computedPrice()},payItem:function(e){this.active=e},changeAddress:function(e){this.addressInfo=e},createOrder:function(){var e=this,t=this.shipping_type;if(!this.active)return this.$dialog.toast({mes:"请选择支付方式"});if(!this.addressInfo.id&&!this.shipping_type)return this.$dialog.toast({mes:"请选择收货地址"});if(this.shipping_type){if((""===this.contacts||""===this.contactsTel)&&this.shipping_type)return this.$dialog.toast({mes:"请填写联系人或联系人电话"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/.test(this.contactsTel))return this.$dialog.toast({mes:"请填写正确的手机号"});if(!/^[\u4e00-\u9fa5\w]{2,16}$/.test(this.contacts))return this.$dialog.toast({mes:"请填写您的真实姓名"})}this.$dialog.loading.open("生成订单中"),Object(c["b"])(this.orderGroupInfo.orderKey,{real_name:this.contacts,phone:this.contactsTel,addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,payType:this.active,pinkId:this.pinkId,seckill_id:this.orderGroupInfo.seckill_id,combinationId:this.orderGroupInfo.combination_id,bargainId:this.orderGroupInfo.bargain_id,from:this.from,mark:this.mark||"",shipping_type:parseInt(t)+1}).then(function(t){e.$dialog.loading.close();var s=t.data,a="/order/status/"+s.result.orderId;switch(s.status){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_DEFICIENCY":case"PAY_ERROR":e.$dialog.toast({mes:t.msg}),e.$router.replace({path:a+"/0?msg="+t.msg});break;case"SUCCESS":e.$dialog.success(t.msg),e.$router.replace({path:a+"/1"});break;case"WECHAT_H5_PAY":e.$router.replace({path:a+"/2"}),setTimeout(function(){location.href=s.result.jsConfig.mweb_url},100);break;case"WECHAT_PAY":Object(l["pay"])(s.result.jsConfig).finally(function(){e.$router.replace({path:a+"/4"})})}}).catch(function(t){console.log(t),e.$dialog.loading.close(),e.$dialog.error(t.msg||"创建订单失败")})}}},_=f,m=(s("d802"),s("2877")),h=Object(m["a"])(_,a,i,!1,null,"2f6e999c",null);t["default"]=h.exports},"713c":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"orderGoods"},[s("div",{staticClass:"total"},[e._v("共"+e._s(e.cartInfo.length)+"件商品")]),s("div",{staticClass:"goodWrapper"},e._l(e.cartInfo,function(t){return s("div",{key:t.id,staticClass:"item acea-row row-between-wrapper"},[s("div",{staticClass:"pictrue"},[s("img",{staticClass:"image",attrs:{src:t.productInfo.image}})]),s("div",{staticClass:"text"},[s("div",{staticClass:"acea-row row-between-wrapper"},[s("div",{staticClass:"name line1"},[e._v(e._s(t.productInfo.store_name))]),s("div",{staticClass:"num"},[e._v("x "+e._s(t.cart_num))])]),t.productInfo.attrInfo?s("div",{staticClass:"attr line1"},[e._v("\n          "+e._s(t.productInfo.attrInfo.suk)+"\n        ")]):e._e(),s("div",{staticClass:"money font-color-red"},[e._v("￥"+e._s(t.truePrice))]),3===e.evaluate?s("div",{staticClass:"evaluate",on:{click:function(s){return e.$router.push({path:"/goods_evaluate/"+t.unique})}}},[e._v("\n          评价\n        ")]):e._e()])])}),0)])},i=[],o=(s("c5f6"),{name:"OrderGoods",props:{evaluate:Number,cartInfo:{type:Array,default:function(){return[]}}},data:function(){return{}},mounted:function(){},methods:{}}),r=o,n=s("2877"),c=Object(n["a"])(r,a,i,!1,null,null,null);t["a"]=c.exports},afa3:function(e,t,s){e.exports=s.p+"h5/img/line.05bf1c84.jpg"},d802:function(e,t,s){"use strict";var a=s("5ce8"),i=s.n(a);i.a}}]);
//# sourceMappingURL=chunk-237894cf.7d98a2c4.js.map